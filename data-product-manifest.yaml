---
version: 0.1.0
alias: ufuk_TestMultiTransform_June_14_1
discoveryPort:
  name: Ufuk MultiTransformation Scenario 14 June Test 2
  shortDescription: Test search functionality
  longDescription: search maximum characters for long description
  tags:
    - Dataverse
    - Finance
  domain: ['Finance']
  function: ['Forecast']
  regulatoryFields:
    dataPrivacy: public
    customerInfo: nonPII
    dataOrigin: machineGenerated
    monetaryInfo: nonFinancialData
inputPorts:
  - alias: car_input_port
    description: string
    tags: []
    extra: {}
    syncType: pull
    type: s3-parquet
    connectionUrn: urn:dv:connection:e6256cc3-386f-4a45-8c6e-5c32ea4287ca
    dataSet:
      path: "s3a://dp-input-bucket/user_car_prices_barcelona_2022/"
      filter: brand = 'BMW'
      projection:
        - brand
        - model
        - engine
        - year
        - location
productState:
  updateType: 'scheduled'
  updateSchedule: "*/03 * * * *"
  updateStrategy: append
  logicalSchema:
    properties:
      brand:
        type: string
      model:
        type: string
      engine:
        type: string
      year:
        type: string
      location:
        type: string
transformation:
    - alias: "car_price_step_1"
      description: "step_1"
      type: sql
      sequenceNo: 1
      stepName: one
      query: "SELECT * FROM car_input_port"
      references:
        - alias: 'car_input_port'
          sqlReference: 'car_input_port'
    - alias: "car_price_step_2"
      description: "step_2"
      query: "SELECT * FROM car_price_step_1"
      type: sql
      sequenceNo: 1
      stepName: one
      references:
        - alias: 'car_price_step_1'
          sqlReference: 'car_price_step_1'
outputPort:
  subscriptionChannels:
    - channelType: rest-api
      queryType: sql
controlPort:
  dataQualityRules:
    RecordCountCheck:
      inputPort:
        - referenceAlias: car_input_port
          expression: ">="
          number: 100
      productState:
        referenceAlias: car_input_port_001
        expression: ==
        number: 100
